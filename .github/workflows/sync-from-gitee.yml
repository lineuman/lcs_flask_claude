name: Sync Gitee to GitHub

on:
  workflow_dispatch:
  schedule:
    - cron: '0 6,14,15,16 * * *'

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Sync from Gitee to GitHub
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}  # 确保这个 secret 存在！
        run: |
          set -ex

          # 克隆 Gitee 仓库
          git clone https://gitee.com/lineuman/lcs_flask_claude.git repo
          cd repo

          # 设置用户信息（必须）
          git config user.name "lineuman"
          git config user.email "actions@github.com"

          # 添加 GitHub 远程仓库
          git remote add github https://${{ secrets.GH_TOKEN }}@github.com/lineuman/lcs_flask_claude.git

          # 强制推送到 GitHub 的 master 分支
          git push -f github master

          echo "🎉 Sync completed!"
